# 項目10 `toString` を常にオーバーライドする

優れた `toString` を実装することで、そのクラスがかなり使いやすくなる。

## `Object` が提供している `toString`

`java.lang.Object` の `toString` が返す文字列は、
`クラス名@符号なしハッシュコード` で構成された文字列であり、ユーザが望むものではない。

以下は、`Object#toString` のjavadocから引用してきたもの。

> オブジェクトの文字列表現を返します。
> 一般に、toStringメソッドは、このオブジェクトを「テキストで表す」文字列を返します。
> この結果は、人間が読める簡潔で有益な情報であるべきです。
> すべてのサブクラスで、このメソッドをオーバーライドすることをお薦めします。  
> 
> クラスObjectのtoStringメソッドは、オブジェクトがインスタンスになっている元のクラスの名前、
> アットマーク文字「@」、およびオブジェクトのハッシュ・コードの符号なし16進数表現から構成される文字列を返します。
> つまり、このメソッドは次の値と等しい文字列を返します。
> 
>  `getClass().getName() + '@' + Integer.toHexString(hashCode())`

javadocにも記載してある通り、*「すべてのサブクラスで、このメソッドをオーバーライドすることをお薦めします。」*。

equals契約やhashCode契約ほどの重要性は無いが、
優れた `toString` 実装を提供することで、そのクラスがかなり使いやすくなる。


## `toString` をオーバーライドする

例えば電話番号を表す `PhoneNumber` の `toString` を実装してみる。

```java
@Override
public String toString(){
    return String.format("(%03d) %03d-%04d", areaCode, prefix, lineNumber);
}
```

こうすることで、
`PhoneNumber@16f94b`
ではなく
`(090) 1023-4755`
といったように、ユーザにとって有益な情報を提供することができる。

基本的には、今の電話番号のように 
**実用的な場合には `toString` メソッドはオブジェクトに含まれる興味がある情報をすべて返すべき** である。

ただし、オブジェクトが大きかったり、オブジェクトが文字列を表現するのに向いてない状態を含んでいる場合には、適切な要約を返すべき。


## `toString` の実装時に決めないといけないこと

それは **ドキュメンテーションで戻り値の形式を明示するかどうか**。

電話番号などの **値クラス** に対しては、明示することが推奨される。

形式を指定した場合、`String` を引数とするstaticファクトリメソッドやコンストラクタを提供することで、
そのオブジェクトと文字列表現間の相互変換が可能になる。  
`BigInteger` や `BigDecimal` 、基本データ型のラッパークラスのほとんどが、文字列とオブジェクトの相互変換が可能。


`toString` の戻り値の形式を明示することによるデメリットとしては、
**一度形式を明示すると、その形式で使用されてしまうため、将来的に形式を変更できなくなってしまう**点。

形式を明示するしないに関係なく、**toStringを実装する意図を明確にドキュメントに書くべき**。  
また、形式を明示する場合には正確に明示するべき。

明示しない場合には、明示しないことをドキュメントに書きましょう。  
そうしないと、プログラマは `toString` に依存したコードを書いてしまう可能性があるため。


## `toString` で返される情報へのアクセサを提供する

形式を明示するしないに関係なく、**`toString`で返される情報のアクセサは提供すること**。  
そうしなければ、その情報を取得するために `toString` で返された文字列を解析する羽目になってしまうため。  
アクセサを提供しなければ、`toString` 実質的なアクセサとなってしまう。